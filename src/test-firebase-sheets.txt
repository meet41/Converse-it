const firebaseConfig = {
  apiKey: "AIzaSyBcDa99xANi_11SXvNIsK-np4HtZvx-mss",
  authDomain: "converseit-7c085.firebaseapp.com",
  databaseURL: "https://converseit-7c085-default-rtdb.firebaseio.com", // Ensure this URL is correct
  projectId: "converseit-7c085",
  storageBucket: "converseit-7c085.appspot.com",
  messagingSenderId: "421382909166",
  appId: "1:421382909166:web:9764fbd2d2420bc0f397ff"
};

function getFirebaseData() {
  const url = `${firebaseConfig.databaseURL}/users.json?auth=${firebaseConfig.apiKey}`;
  const response = UrlFetchApp.fetch(url);
  const data = JSON.parse(response.getContentText());
  return data;
}

function writeToSheet() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const data = getFirebaseData();
  
  // Clear existing content
  sheet.clear();

  // Write headers
  const headers = ["Name", "Department", "Email", "Year", "Contact Number"];
  sheet.appendRow(headers);

  // Write data
  for (const key in data) {
    if (data.hasOwnProperty(key)) {
      const user = data[key];
      const row = [user.name, user.department, user.email, user.year, user.contactNumber];
      sheet.appendRow(row);
    }
  }
}